# 还款周期功能说明与数据库迁移

## 功能说明

- **还款日**：在「还款周期」页可设置每月几号为还款日（1–28 号），用于划分账单周期。
- **周期划分**：从本月还款日到下一还款日的前一天为一个周期（例如还款日 15 号：2月15日–3月14日为一个周期）。
- **按周期查看**：列表展示每个周期的收入、支出、结余与笔数；可设置**预期收入/预期支出**，便于控制开销。
- **查看明细**：点击某周期的「查看明细」跳转到交易记录，并自动带上该周期的日期范围筛选。
- **生成分享图**：可为任意周期生成分享图（含统计与环形图，若设置了预期会一并展示），保存或分享到微信、QQ 等。

## 数据库迁移（首次使用还款周期前必做）

当前项目使用 `ddl-auto: none`，不会自动建表。使用还款周期前需手动执行一次迁移，创建 `user_settings` 和 `billing_cycle_budget` 表。

### 方式一：命令行（在项目根目录）

```bash
sqlite3 database/accounting.db < database/migration_billing_cycle.sql
```

若 `database` 或 `accounting.db` 路径不同，请改为你的实际路径。

### 方式二：用 SQLite 图形工具

1. 用 DB Browser for SQLite、DBeaver 等打开 `database/accounting.db`。
2. 打开并执行 `database/migration_billing_cycle.sql` 中的全部 SQL。

执行成功后即可在应用内使用「还款周期」页与按周期生成分享图。
